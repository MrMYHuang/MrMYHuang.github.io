import{d as b,e as A,f as B,b as P,p as T,g as M,h as N,j as x}from"./index.0531b304.js";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const L=new WeakMap,g=(e,t,o,r=0)=>{L.has(e)!==o&&(o?p(e,t,r):R(e,t))},C=e=>e===e.getRootNode().activeElement,p=(e,t,o)=>{const r=t.parentNode,n=t.cloneNode(!1);n.classList.add("cloned-input"),n.tabIndex=-1,r.appendChild(n),L.set(e,n);const d=e.ownerDocument.dir==="rtl"?9999:-9999;e.style.pointerEvents="none",t.style.transform=`translate3d(${d}px,${o}px,0) scale(0)`},R=(e,t)=>{const o=L.get(e);o&&(L.delete(e),o.remove()),e.style.pointerEvents="",t.style.transform=""},K=(e,t,o)=>{if(!o||!t)return()=>{};const r=a=>{C(t)&&g(e,t,a)},n=()=>g(e,t,!1),s=()=>r(!0),d=()=>r(!1);return A(o,"ionScrollStart",s),A(o,"ionScrollEnd",d),t.addEventListener("blur",n),()=>{b(o,"ionScrollStart",s),b(o,"ionScrollEnd",d),t.addEventListener("ionBlur",n)}},y="input, textarea, [no-blur], [contenteditable]",_=()=>{let e=!0,t=!1;const o=document,r=()=>{t=!0},n=()=>{e=!0},s=d=>{if(t){t=!1;return}const a=o.activeElement;if(!a||a.matches(y))return;const c=d.target;c!==a&&(c.matches(y)||c.closest(y)||(e=!1,setTimeout(()=>{e||a.blur()},50)))};return A(o,"ionScrollStart",r),o.addEventListener("focusin",n,!0),o.addEventListener("touchend",s,!1),()=>{b(o,"ionScrollStart",r,!0),o.removeEventListener("focusin",n,!0),o.removeEventListener("touchend",s,!1)}},O=.3,F=(e,t,o)=>{const r=e.closest("ion-item,[ion-item]")||e;return k(r.getBoundingClientRect(),t.getBoundingClientRect(),o,e.ownerDocument.defaultView.innerHeight)},k=(e,t,o,r)=>{const n=e.top,s=e.bottom,d=t.top,a=Math.min(t.bottom,r-o),c=d+15,f=a*.75-s,m=c-n,i=Math.round(f<0?-f:m>0?-m:0),u=Math.min(i,n-d),v=Math.abs(u)/O,w=Math.min(400,Math.max(150,v));return{scrollAmount:u,scrollDuration:w,scrollPadding:o,inputSafeY:-(n-c)+4}},H=(e,t,o,r,n)=>{let s;const d=c=>{s=T(c)},a=c=>{if(!s)return;const l=T(c);!Y(6,s,l)&&!C(t)&&U(e,t,o,r,n)};return e.addEventListener("touchstart",d,!0),e.addEventListener("touchend",a,!0),()=>{e.removeEventListener("touchstart",d,!0),e.removeEventListener("touchend",a,!0)}},U=async(e,t,o,r,n)=>{if(!o&&!r)return;const s=F(e,o||r,n);if(o&&Math.abs(s.scrollAmount)<4){t.focus();return}if(g(e,t,!0,s.inputSafeY),t.focus(),M(()=>e.click()),typeof window<"u"){let d;const a=async()=>{d!==void 0&&clearTimeout(d),window.removeEventListener("ionKeyboardDidShow",c),window.removeEventListener("ionKeyboardDidShow",a),o&&await x(o,0,s.scrollAmount,s.scrollDuration),g(e,t,!1,s.inputSafeY),t.focus()},c=()=>{window.removeEventListener("ionKeyboardDidShow",c),window.addEventListener("ionKeyboardDidShow",a)};if(o){const l=await N(o),f=l.scrollHeight-l.clientHeight;if(s.scrollAmount>f-l.scrollTop){t.type==="password"?(s.scrollAmount+=50,window.addEventListener("ionKeyboardDidShow",c)):window.addEventListener("ionKeyboardDidShow",a),d=setTimeout(a,1e3);return}}a()}},Y=(e,t,o)=>{if(t&&o){const r=t.x-o.x,n=t.y-o.y;return r*r+n*n>e*e}return!1},D="$ionPaddingTimer",$=e=>{const t=document,o=n=>{I(n.target,e)},r=n=>{I(n.target,0)};return t.addEventListener("focusin",o),t.addEventListener("focusout",r),()=>{t.removeEventListener("focusin",o),t.removeEventListener("focusout",r)}},I=(e,t)=>{var o,r;if(e.tagName!=="INPUT"||e.parentElement&&e.parentElement.tagName==="ION-INPUT"||((r=(o=e.parentElement)===null||o===void 0?void 0:o.parentElement)===null||r===void 0?void 0:r.tagName)==="ION-SEARCHBAR")return;const n=B(e);if(n===null)return;const s=n[D];s&&clearTimeout(s),t>0?n.style.setProperty("--keyboard-offset",`${t}px`):n[D]=setTimeout(()=>{n.style.setProperty("--keyboard-offset","0px")},120)},q=!0,G=!0,j=e=>{const t=document,o=e.getNumber("keyboardHeight",290),r=e.getBoolean("scrollAssist",!0),n=e.getBoolean("hideCaretOnScroll",!0),s=e.getBoolean("inputBlurring",!0),d=e.getBoolean("scrollPadding",!0),a=Array.from(t.querySelectorAll("ion-input, ion-textarea")),c=new WeakMap,l=new WeakMap,f=async i=>{await new Promise(S=>P(i,S));const u=i.shadowRoot||i,h=u.querySelector("input")||u.querySelector("textarea"),v=B(i),w=v?null:i.closest("ion-footer");if(!!h){if(!!v&&n&&!c.has(i)){const S=K(i,h,v);c.set(i,S)}if((!!v||!!w)&&r&&!l.has(i)){const S=H(i,h,v,w,o);l.set(i,S)}}},m=i=>{if(n){const u=c.get(i);u&&u(),c.delete(i)}if(r){const u=l.get(i);u&&u(),l.delete(i)}};s&&q&&_(),d&&G&&$(o);for(const i of a)f(i);t.addEventListener("ionInputDidLoad",i=>{f(i.detail)}),t.addEventListener("ionInputDidUnload",i=>{m(i.detail)})};export{j as startInputShims};
//# sourceMappingURL=input-shims.0f1b55c1.js.map
