(this.webpackJsonpcbetar2=this.webpackJsonpcbetar2||[]).push([[1],{140:function(e,t,a){},204:function(e){e.exports=JSON.parse('{"name":"cbetar2","version":"2.9.0","private":true,"dependencies":{"@capacitor-community/electron":"^1.2.3","@capacitor/android":"^2.4.0","@capacitor/core":"2.4.0","@ionic/react":"^5.3.3","@ionic/react-router":"^5.3.3","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.4.0","@testing-library/user-event":"^8.0.3","@types/jest":"^24.0.25","@types/node":"^12.12.24","@types/react":"^16.9.17","@types/react-dom":"^16.9.4","@types/react-router":"^5.1.8","@types/react-router-dom":"^5.1.5","axios":"^0.19.2","epubjs-myh":"^0.3.101","history":"^4.10.1","ionicons":"^5.0.0","memfs":"^3.2.0","nodepub":"^2.2.0","query-string":"^6.13.1","react":"^16.13.0","react-dom":"^16.13.0","react-redux":"^7.2.1","react-router":"^5.2.0","react-router-dom":"^5.2.0","react-scripts":"^3.4.3","redux":"^4.0.5","typescript":"3.8.3","uuid":"^8.3.0"},"scripts":{"start":"react-app-rewired start","build":"react-app-rewired build && powershell -file CopyBuild.ps1","build_linux":"react-app-rewired build && ./CopyBuild.sh","test":"react-app-rewired test","eject":"react-scripts eject","android":"npx cap open android","sync":"npx cap sync android"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"@capacitor/cli":"2.4.0","@types/react-redux":"^7.1.9","@types/uuid":"^8.3.0","customize-cra":"^1.0.0","electron-packager":"^15.0.0","react-app-rewired":"^2.1.6"},"description":"An Ionic project"}')},207:function(e,t,a){e.exports=a(400)},213:function(e,t,a){var n={"./ion-action-sheet.entry.js":[402,5],"./ion-alert.entry.js":[403,6],"./ion-app_8.entry.js":[404,7],"./ion-avatar_3.entry.js":[405,18],"./ion-back-button.entry.js":[406,19],"./ion-backdrop.entry.js":[407,43],"./ion-button_2.entry.js":[408,20],"./ion-card_5.entry.js":[409,21],"./ion-checkbox.entry.js":[410,22],"./ion-chip.entry.js":[411,23],"./ion-col_3.entry.js":[412,44],"./ion-datetime_3.entry.js":[413,10],"./ion-fab_3.entry.js":[414,24],"./ion-img.entry.js":[415,45],"./ion-infinite-scroll_2.entry.js":[416,46],"./ion-input.entry.js":[417,25],"./ion-item-option_3.entry.js":[418,26],"./ion-item_8.entry.js":[419,27],"./ion-loading.entry.js":[420,28],"./ion-menu_3.entry.js":[421,29],"./ion-modal.entry.js":[422,8],"./ion-nav_2.entry.js":[423,15],"./ion-popover.entry.js":[424,9],"./ion-progress-bar.entry.js":[425,30],"./ion-radio_2.entry.js":[426,31],"./ion-range.entry.js":[427,32],"./ion-refresher_2.entry.js":[428,11],"./ion-reorder_2.entry.js":[429,17],"./ion-ripple-effect.entry.js":[430,47],"./ion-route_4.entry.js":[431,33],"./ion-searchbar.entry.js":[432,34],"./ion-segment_2.entry.js":[433,35],"./ion-select_3.entry.js":[434,36],"./ion-slide_2.entry.js":[435,48],"./ion-spinner.entry.js":[436,13],"./ion-split-pane.entry.js":[437,49],"./ion-tab-bar_2.entry.js":[438,37],"./ion-tab_2.entry.js":[439,16],"./ion-text.entry.js":[440,38],"./ion-textarea.entry.js":[441,39],"./ion-toast.entry.js":[442,40],"./ion-toggle.entry.js":[443,12],"./ion-virtual-scroll.entry.js":[444,50]};function r(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return a.e(t[1]).then((function(){return a(r)}))}r.keys=function(){return Object.keys(n)},r.id=213,e.exports=r},226:function(e,t,a){var n={"./ion-icon.entry.js":[448,57]};function r(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return a.e(t[1]).then((function(){return a(r)}))}r.keys=function(){return Object.keys(n)},r.id=226,e.exports=r},248:function(e,t,a){},252:function(e,t,a){},294:function(e,t){},296:function(e,t){},328:function(e,t){},330:function(e,t){},336:function(e,t){},338:function(e,t){},346:function(e,t){},348:function(e,t){},358:function(e,t){},360:function(e,t){},398:function(e,t,a){},399:function(e,t,a){},400:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(55),s=a.n(o),i=a(85),c=a(7),l=a.n(c),u=a(16),p=a(3),h=a(4),m=a(10),d=a(11),f=a(19),v=a(1),k=a(195),y=a(30),b=a(56),g=a(24),E=a(42),w=a(197),S=a.n(w),x="https://cbdata.dila.edu.tw/".concat("v1.2"),j=S.a.create({baseURL:x,timeout:3e3});function A(e){switch(e){case 0:return 0;case 1:return 20;case 2:return 40}}function O(e,t){return"".concat(e,"_juan").concat(t,".html")}function C(){return(C=Object(u.a)(l.a.mark((function e(t,a,n){var r,o,s,i,c,u,p,h,m,d=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d.length>3&&void 0!==d[3]&&d[3],o=O(t,a),null==(s=localStorage.getItem(o))||r){e.next=6;break}e.next=25;break;case 6:if(!n){e.next=15;break}return e.next=9,j.get("/".concat(n),{responseType:"arraybuffer"});case 9:i=e.sent,c=new TextDecoder,u=c.decode(i.data),s=u.includes("charset=big5")?new TextDecoder("big5").decode(i.data):u,e.next=20;break;case 15:return e.next=17,j.get("/juans?edition=CBETA&work=".concat(t,"&juan=").concat(a),{responseType:"arraybuffer"});case 17:p=e.sent,h=JSON.parse((new TextDecoder).decode(p.data)),s=h.results[0];case 20:(m=document.implementation.createHTMLDocument("")).body.innerHTML=s,s=(s=(s=(new XMLSerializer).serializeToString(m.body)).replace("<body","<div")).replace("/body>","/div>");case 25:return e.abrupt("return",s);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T,z={storeFile:"Settings.json",fontSizeNorm:24,fontSizeLarge:48,apiVersion:"v1.2",cbetaApiUrl:x,dilaDictApiUrl:"https://glossaries.dila.edu.tw/search.json",axiosInstance:j,topCatalogsByCat:{CBETA:"CBETA \u90e8\u985e","Cat-T":"\u5927\u6b63\u85cf","Cat-X":"\u534d\u7e8c\u85cf","Cat-N":"\u5357\u50b3\u5927\u85cf\u7d93",others:"\u6b77\u4ee3\u85cf\u7d93\u88dc\u8f2f",modern:"\u8fd1\u4ee3\u65b0\u7de8\u6587\u737b"},topCatalogsByVol:{"Vol-T":"T \u5927\u6b63\u85cf","Vol-X":"X \u534d\u7e8c\u85cf","Vol-A":"A \u8d99\u57ce\u91d1\u85cf","Vol-K":"K \u9ad8\u9e97\u5927\u85cf\u7d93-\u65b0\u6587\u8c50\u7248","Vol-S":"S \u5b8b\u85cf\u907a\u73cd-\u65b0\u6587\u8c50\u7248","Vol-F":"F \u623f\u5c71\u77f3\u7d93","Vol-C":"C \u4e2d\u83ef\u5927\u85cf\u7d93-\u4e2d\u83ef\u66f8\u5c40\u7248","Vol-U":"U \u6d2a\u6b66\u5357\u85cf","Vol-P":"P \u6c38\u6a02\u5317\u85cf","Vol-J":"J \u5609\u8208\u85cf","Vol-L":"L \u4e7e\u9686\u5927\u85cf\u7d93-\u65b0\u6587\u8c50\u7248","Vol-G":"G \u4f5b\u6559\u5927\u85cf\u7d93","Vol-M":"M \u534d\u6b63\u85cf\u7d93-\u65b0\u6587\u8c50\u7248","Vol-D":"D \u570b\u5716\u5584\u672c","Vol-N":"N \u5357\u50b3\u5927\u85cf\u7d93(\u518a\u5225)","Vol-ZS":"ZS \u6b63\u53f2\u4f5b\u6559\u8cc7\u6599\u985e\u7de8","Vol-I":"I \u5317\u671d\u4f5b\u6559\u77f3\u523b\u62d3\u7247\u767e\u54c1","Vol-ZW":"ZW \u85cf\u5916\u4f5b\u6559\u6587\u737b","Vol-B":"B \u5927\u85cf\u7d93\u88dc\u7de8","Vol-GA":"GA \u4e2d\u570b\u4f5b\u5bfa\u53f2\u5fd7\u5f59\u520a","Vol-GB":"GB \u4e2d\u570b\u4f5b\u5bfa\u5fd7\u53e2\u520a","Vol-Y":"Y \u5370\u9806\u6cd5\u5e2b\u4f5b\u5b78\u8457\u4f5c\u96c6","Vol-LC":"LC \u5442\u6f82\u4f5b\u5b78\u8457\u4f5c\u96c6"},fetchErrorContent:r.a.createElement(v.m,{className:"contentCenter"},r.a.createElement("div",null,r.a.createElement("div",null,"\u9023\u7dda\u5931\u6557!"),r.a.createElement("div",{style:{fontSize:"var(--ui-font-size)",paddingTop:24}},"\u82e5\u5176\u5b83app\u80fd\u4e0a\u7db2\uff0c\u53ef\u80fd\u662fCBETA API\u7570\u5e38\uff0c\u8acb\u975c\u5f85\u4fee\u5fa9\u3002"))),updateApp:function(){navigator.serviceWorker.getRegistrations().then((function(e){return Promise.all(e.map((function(e){return e.update()})))}))},scrollbarSizeIdToValue:A,updateCssVars:function(e){var t=A(e.scrollbarSize);document.documentElement.style.cssText="--ion-font-family: ".concat(e.useFontKai?"Heiti, Times, Kai":"Times, Heiti",";\n        --scrollbar-size: ").concat(t,"px; --ui-font-size: ").concat(e.uiFontSize,"px")},isTouchDevice:function(){return Object(v.N)("ios")||Object(v.N)("android")},fetchJuan:function(e,t,a){return C.apply(this,arguments)},getFileName:O};!function(e){e[e.CATALOG=0]="CATALOG",e[e.WORK=1]="WORK",e[e.JUAN=2]="JUAN"}(T||(T={}));var N=function e(t){Object(p.a)(this,e),this.type=T.CATALOG,this.uuid="",this.work=null,this.selectedText="",this.epubcfi="",this.fileName="",this.type=t.type,this.uuid=t.uuid,this.work=t.work,this.selectedText=t.selectedText,this.epubcfi=t.epubcfi,this.fileName=t.fileName};var I=Object(b.b)({settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=Object(E.a)({},e);switch(t.type){case"SET_KEY_VAL":var n=t.key,r=t.val;a[n]=r,localStorage.setItem(z.storeFile,JSON.stringify({settings:a}));break;case"ADD_BOOKMARK":var o=a.bookmarks,s=t.bookmark.fileName;null===s||""===s||o.some((function(e){return e.fileName===s}))||localStorage.setItem(s,t.htmlStr),a.bookmarks=[].concat(Object(g.a)(a.bookmarks),[t.bookmark]),localStorage.setItem(z.storeFile,JSON.stringify({settings:a}));break;case"DEL_BOOKMARK":var i=a.bookmarks,c=i.findIndex((function(e){return e.uuid===t.uuid}));if(-1!==c){var l=i.splice(c,1);if(1===l.length){var u=l[0],p=u.fileName,h=null==i.find((function(e){return e.type===T.JUAN&&e.uuid===u.uuid})),m=null==i.find((function(e){var t,a;return e.type===T.WORK&&(null===(t=e.work)||void 0===t?void 0:t.work)===(null===(a=u.work)||void 0===a?void 0:a.work)}));if(m)switch(u.type){case T.WORK:var d=u.work;if(null==d)break;for(var f=d.juan_list.split(","),v=function(e){var t=z.getFileName(d.work,f[e]);(h=null==i.find((function(e){return e.type===T.JUAN&&e.fileName===t})))&&localStorage.removeItem(t)},k=0;k<f.length;k++)v(k);break;case T.JUAN:h&&localStorage.removeItem(p)}}}a.bookmarks=Object(g.a)(i),localStorage.setItem(z.storeFile,JSON.stringify({settings:a}));break;default:0===Object.keys(a).length&&(a={});for(var y=["topCatalogsType","theme","paginated","rtlVerticalLayout","scrollbarSize","useFontKai","fontSize","uiFontSize","showComments","speechRate","bookmarks"],b=[0,0,1,1,2,1,32,24,0,.8,[]],w=0;w<y.length;w++)void 0===a[y[w]]&&(a[y[w]]=b[w])}return a},tmpSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=Object(E.a)({},e),n=t.key,r=t.val;switch(a[n]=r,t.type){case"TMP_SET_KEY_VAL":return a}return e}});var L,_=a(8),B=(a(248),function e(t){Object(p.a)(this,e),this.n=void 0,this.nodeType=void 0,this.label=void 0,this.work=void 0,this.file=void 0,this.n=t.n,this.nodeType=t.node_type,this.label=t.label,this.work=t.work,this.file=t.file}),D=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{cssClass:"uiFont",isOpen:this.props.showSearchAlert,header:"\u641c\u5c0b\u7d93\u6587",subHeader:"\u8f38\u5165\u641c\u5c0b",inputs:[{name:"name0",type:"search",placeholder:"\u4f8b:\u91d1\u525b\u822c\u82e5"}],buttons:[{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary uiFont",handler:function(){return e.props.searchCancel()}},{text:"\u78ba\u5b9a",cssClass:"primary uiFont",handler:function(t){e.props.searchOk(t.name0)}}]})}}]),a}(r.a.Component),F=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).state={fetchError:!1,catalogs:[],showSearchAlert:!1},n}return Object(h.a)(a,[{key:"ionViewWillEnter",value:function(){this.fetchData(this.props.match.params.path)}},{key:"fetchData",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Array,null!=this.props.match.params.path){e.next=5;break}return e.abrupt("return",this.fetchTopCatalogs(this.props.topCatalogsType));case 5:return e.prev=5,e.next=8,z.axiosInstance.get("/catalog_entry?q=".concat(t),{responseType:"arraybuffer"});case 8:n=e.sent,r=JSON.parse((new TextDecoder).decode(n.data)).results,a=r.map((function(e){return new B(e)})),e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(5),console.error(e.t0),this.setState({fetchError:!0}),e.abrupt("return",!1);case 18:return this.setState({catalogs:a}),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchTopCatalogs",value:function(e){var t=Array(),a=e?z.topCatalogsByVol:z.topCatalogsByCat;return Object.keys(a).forEach((function(e){var n={n:e,nodeType:null,work:null,label:a[e],file:null};t.push(n)})),this.setState({catalogs:t}),!0}},{key:"addBookmarkHandler",value:function(){this.props.dispatch({type:"ADD_BOOKMARK",bookmark:new N({type:T.CATALOG,uuid:this.props.match.params.path,selectedText:this.props.match.params.label,epubcfi:"",fileName:"",work:null})})}},{key:"delBookmarkHandler",value:function(){this.props.dispatch({type:"DEL_BOOKMARK",uuid:this.props.match.params.path})}},{key:"getRows",value:function(){var e=this,t=Array();return this.state.catalogs.forEach((function(a,n){var o="";o="html"===a.nodeType?"/catalog/webview/".concat(a.n,"/1/").concat(a.label):null==a.work?"/catalog/catalog/".concat(a.n,"/").concat(a.label):"/catalog/work/".concat(a.work,"/").concat(a.label),t.push(r.a.createElement(v.i,{key:"".concat(a.n,"item")+n,button:!0,onClick:function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),e.props.history.push({pathname:o});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"},key:"".concat(a.n,"label")+n},a.label)))})),t}},{key:"render",value:function(){var e=this,t=r.a.createElement(v.n,null,this.getRows());return r.a.createElement(v.p,null,r.a.createElement(v.g,null,r.a.createElement(v.E,null,r.a.createElement(v.B,{style:{fontSize:"var(--ui-font-size)"}},"\u76ee\u9304"),r.a.createElement(v.c,{hidden:this.isTopCatalog,fill:"clear",slot:"start",onClick:function(t){return e.props.history.goBack()}},r.a.createElement(v.h,{icon:_.a,slot:"icon-only"})),r.a.createElement(v.c,{hidden:!this.isTopCatalog,slot:"end",onClick:function(t){var a=(e.props.topCatalogsType+1)%2;e.fetchTopCatalogs(a),e.props.dispatch({type:"SET_KEY_VAL",key:"topCatalogsType",val:a})}},r.a.createElement("span",{style:{color:"var(--color)"}},this.props.topCatalogsType?"\u518a\u5206\u985e":"\u90e8\u5206\u985e")),r.a.createElement(v.c,{hidden:this.isTopCatalog,fill:"clear",color:this.hasBookmark?"warning":"primary",slot:"end",onClick:function(t){return e.hasBookmark?e.delBookmarkHandler():e.addBookmarkHandler()}},r.a.createElement(v.h,{icon:_.e,slot:"icon-only"})),r.a.createElement(v.c,{hidden:this.isTopCatalog,fill:"clear",slot:"end",onClick:function(t){return e.props.history.push("/".concat(e.props.match.params.tab))}},r.a.createElement(v.h,{icon:_.r,slot:"icon-only"})),r.a.createElement(v.c,{fill:"clear",slot:"end",onClick:function(t){return e.setState({showSearchAlert:!0})}},r.a.createElement(v.h,{icon:_.A,slot:"icon-only"})))),r.a.createElement(v.d,null,this.state.fetchError?z.fetchErrorContent:t,r.a.createElement(D,Object(E.a)({showSearchAlert:this.state.showSearchAlert,searchCancel:function(){e.setState({showSearchAlert:!1})},searchOk:function(t){e.props.history.push("/catalog/search/".concat(t)),e.setState({showSearchAlert:!1})}},this.props)),r.a.createElement("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"}},r.a.createElement("a",{href:"https://github.com/MrMYHuang/cbetar2#search",target:"_new"},"\u641c\u5c0b\u7d93\u6587\u6559\u5b78"))))}},{key:"isTopCatalog",get:function(){return"/catalog"===this.props.match.url}},{key:"hasBookmark",get:function(){var e,t=this;return null!=(null===(e=this.props.bookmarks)||void 0===e?void 0:e.find((function(e){return e.type===T.CATALOG&&e.uuid===t.props.match.params.path})))}}]),a}(r.a.Component),V=Object(v.P)(F),U=Object(y.b)((function(e){return{bookmarks:e.settings.bookmarks,topCatalogsType:e.settings.topCatalogsType}}))(V),P=(a(140),function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).fetchJuan="",n.state={work:null,showSearchAlert:!1,showAddBookmarkDone:!1},n}return Object(h.a)(a,[{key:"ionViewWillEnter",value:function(){this.fetchWork(this.props.match.params.path)}},{key:"fetchWork",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasBookmark){e.next=4;break}a=this.bookmark.work,e.next=10;break;case 4:return e.next=6,z.axiosInstance.get("/works?work=".concat(t),{responseType:"arraybuffer"});case 6:n=e.sent,r=JSON.parse((new TextDecoder).decode(n.data)),o=r.results,a=o[0];case 10:return this.setState({work:a}),e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveJuans",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.work,a=t.juan_list.split(","),n=0;case 3:if(!(n<a.length)){e.next=18;break}return this.fetchJuan=a[n],e.prev=5,e.next=8,z.fetchJuan(t.work,this.fetchJuan,null);case 8:r=e.sent,localStorage.setItem(z.getFileName(t.work,this.fetchJuan),r),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.error("Fetching juan ".concat(n," failed!"));case 15:n++,e.next=3;break;case 18:this.setState({showAddBookmarkDone:!0});case 19:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"addBookmarkHandler",value:function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveJuans();case 2:this.props.dispatch({type:"ADD_BOOKMARK",bookmark:new N({type:T.WORK,uuid:this.props.match.params.path,selectedText:this.props.match.params.label,epubcfi:"",fileName:"",work:this.state.work})});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delBookmarkHandler",value:function(){this.props.dispatch({type:"DEL_BOOKMARK",uuid:this.props.match.params.path})}},{key:"getRows",value:function(){for(var e=this,t=this.state.work,a=Array(),n=t.juan_list.split(","),o=function(o){var s="/catalog/webview/".concat(t.work,"/").concat(n[o],"/").concat(t.title);a.push(r.a.createElement(v.i,{key:"juanItem"+o,button:!0,onClick:function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),e.props.history.push({pathname:s});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"},key:"juanLabel"+o},"\u5377",n[o])))},s=0;s<n.length;s++)o(s);return a}},{key:"render",value:function(){var e=this;if(null==this.state.work)return r.a.createElement(v.p,null);var t=this.getRows();return r.a.createElement(v.p,null,r.a.createElement(v.g,null,r.a.createElement(v.E,null,r.a.createElement(v.B,{style:{fontSize:"var(--ui-font-size)"}},this.state.work.title),r.a.createElement(v.c,{hidden:this.isTopPage,fill:"clear",slot:"start",onClick:function(t){return e.props.history.goBack()}},r.a.createElement(v.h,{icon:_.a,slot:"icon-only"})),r.a.createElement(v.c,{fill:"clear",color:this.hasBookmark?"warning":"primary",slot:"end",onClick:function(t){return e.hasBookmark?e.delBookmarkHandler():e.addBookmarkHandler()}},r.a.createElement(v.h,{icon:_.e,slot:"icon-only"})),r.a.createElement(v.c,{fill:"clear",slot:"end",onClick:function(t){return e.props.history.push("/".concat(e.props.match.params.tab))}},r.a.createElement(v.h,{icon:_.r,slot:"icon-only"})),r.a.createElement(v.c,{fill:"clear",slot:"end",onClick:function(t){return e.setState({showSearchAlert:!0})}},r.a.createElement(v.h,{icon:_.A,slot:"icon-only"})))),r.a.createElement(v.d,null,r.a.createElement(v.n,null,t),r.a.createElement(D,Object(E.a)({showSearchAlert:this.state.showSearchAlert,searchCancel:function(){e.setState({showSearchAlert:!1})},searchOk:function(t){e.props.history.push("/catalog/search/".concat(t)),e.setState({showSearchAlert:!1})}},this.props)),r.a.createElement(v.C,{cssClass:"uiFont",isOpen:this.state.showAddBookmarkDone,onDidDismiss:function(){return e.setState({showAddBookmarkDone:!1})},message:"\u66f8\u7c64\u65b0\u589e\u6210\u529f\uff01",duration:2e3})))}},{key:"isTopPage",get:function(){return"/catalog"===this.props.match.url}},{key:"bookmark",get:function(){var e=this;return this.props.bookmarks.find((function(t){return t.type===T.WORK&&t.uuid===e.props.match.params.path}))}},{key:"hasBookmark",get:function(){return null!=this.bookmark}}]),a}(r.a.Component)),R=Object(v.P)(P),K=Object(y.b)((function(e){return{bookmarks:e.settings.bookmarks}}))(R),M=a(15),J=a(451),W=a(198),H=a.n(W),G=(a(252),function e(t){Object(p.a)(this,e),this.title=void 0,this.juan=void 0,this.juan_list=void 0,this.work=void 0,this.title=t.title,this.juan=t.juan,this.juan_list=t.juan_list,this.work=t.work}),Y=a(199),q=a(203);!function(e){e[e.UNINITIAL=0]="UNINITIAL",e[e.SPEAKING=1]="SPEAKING",e[e.PAUSE=2]="PAUSE"}(L||(L={}));var X=function(e){Object(m.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).htmlFile=void 0,a.book=void 0,a.rendition=void 0,a.epub=void 0,a.displayed=void 0,a.cfiRange=void 0,a.speechSynthesisUtterance=void 0,a.uuidStr="",a.epubcfi="",a.bookCreated=!1,a.maxCharsPerUtterance=1e3,a.workTexts=[],a.workTextsIndex=0,a.state={isLoading:!0,fetchError:!1,htmlStr:null,showNoSelectedTextAlert:!1,showAddBookmarkSuccess:!1,showSearchAlert:!1,popover:{show:!1,event:null},lookupDictPopover:{show:!1,data:[]},speechState:L.UNINITIAL},a.htmlFile="",a.book=null,a.rendition=null,a.cfiRange="",a.speechSynthesisUtterance=new SpeechSynthesisUtterance,a.speechSynthesisUtterance.lang="zh-TW",a.speechSynthesisUtterance.onend=function(e){a.state.speechState!==L.UNINITIAL&&(a.workTextsIndex<a.workTexts.length-1?(a.workTextsIndex+=1,a.speechSynthesisUtterance.text=a.workTexts[a.workTextsIndex],speechSynthesis.speak(a.speechSynthesisUtterance),console.log("Play work text to speech part: ".concat(a.workTextsIndex))):(a.setState({speechState:L.UNINITIAL}),console.log("Stop work text to speech.")))},document.addEventListener("keyup",a.keyListener.bind(Object(M.a)(a)),!1),a}return Object(h.a)(n,[{key:"loadEpubCoverToMemFs",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=new Uint8Array(JSON.parse(localStorage.getItem("logo.png")||"[]"))).length){e.next=8;break}return e.next=4,z.axiosInstance.get("".concat(window.location.origin,"/assets/icon/icon.png"),{responseType:"arraybuffer"});case 4:n=e.sent,t=new Uint8Array(n.data),r=JSON.stringify(Array.from(t)),localStorage.setItem("logo.png",r);case 8:a(49).writeFileSync("logo.png",t);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"ionViewWillEnter",value:function(){this.setState({isLoading:!0});var e=H.a.parse(this.props.location.search);this.htmlFile=e.file;var t=this.props.location.state;this.uuidStr=t?t.uuid:"",this.fetchData()}},{key:"ionViewDidEnter",value:function(){}},{key:"fetchData",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.prev=1,e.next=4,z.fetchJuan(this.props.match.params.work,this.props.match.params.path,this.htmlFile);case 4:t=e.sent,e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(1),console.error(e.t0),this.setState({isLoading:!1,fetchError:!0}),e.abrupt("return",!1);case 12:return e.next=14,this.loadEpubCoverToMemFs();case 14:return this.setState({htmlStr:t}),e.abrupt("return",!0);case 16:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"addBookmarkHandler",value:function(){var e=document.getElementsByTagName("iframe")[0].contentWindow,t=null===e||void 0===e?void 0:e.getSelection();if(null===t||void 0===t?void 0:t.rangeCount){var a=J.a();this.props.dispatch({type:"ADD_BOOKMARK",htmlStr:this.state.htmlStr,bookmark:new N({type:T.JUAN,uuid:a,selectedText:t.toString(),epubcfi:this.epubcfi,fileName:"".concat(this.props.match.params.work,"_juan").concat(this.props.match.params.path,".html"),work:new G({juan:this.props.match.params.path,title:this.props.match.params.label,work:this.props.match.params.work})})}),null===t||void 0===t||t.removeAllRanges(),this.setState({showAddBookmarkSuccess:!0})}else this.setState({showNoSelectedTextAlert:!0})}},{key:"ionViewWillLeave",value:function(){var e;speechSynthesis.cancel(),this.setState({htmlStr:null,speechState:L.UNINITIAL}),null===(e=this.book)||void 0===e||e.destroy(),this.book=null,this.bookCreated=!1}},{key:"pagePrev",value:function(){var e;this.props.paginated&&(null===(e=this.rendition)||void 0===e||e.prev())}},{key:"pageNext",value:function(){var e;this.props.paginated&&(null===(e=this.rendition)||void 0===e||e.next())}},{key:"keyListener",value:function(e){var t=e.keyCode||e.which;console.log(e.type),t===(this.props.rtlVerticalLayout?37:40)&&this.pageNext(),t===(this.props.rtlVerticalLayout?39:38)&&this.pagePrev()}},{key:"html2Epub",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.bookCreated=!0,this.epub=q.document({id:"123-123456789",title:"Title",series:"",sequence:1,author:"Author",fileAs:"",genre:"genre",tags:"",copyright:"",publisher:"",published:"",language:"en",description:"A temp book.",contents:this.props.match.params.label,source:"",images:["logo.png"]},"logo.png"),this.epub.addSection("",this.state.htmlStr,!0,!1),"\n    html {\n      writing-mode: vertical-rl;\n      direction: ltr;\n    }\n    ",this.epub.addCSS("\n    @font-face {\n        font-family: 'Kai';\n        font-style: normal;\n        font-weight: 500;\n        /* Font source: https://data.gov.tw/dataset/5961 */\n        src: url('".concat(window.location.origin,"/assets/TW-Kai-98_1.woff');\n        font-display: swap;\n    }\n\n    @font-face {\n        font-family: 'Times';\n        src: local('Times New Roman');\n        unicode-range: U+0-007F;\n    }\n\n    /* Workaround parenthesis orientation problem of TW-Kai-98_1 on iOS Safari. */\n    @font-face {\n        font-family: 'Heiti';\n        src: local('Heiti TC');\n        unicode-range: U+3008-301B, U+FF01-FF60;\n    }\n\n    .lb {\n      display: none\n    }\n  \n    ").concat(this.props.rtlVerticalLayout?"\n    html {\n      writing-mode: vertical-rl;\n      direction: ltr;\n    }\n    ":"","\n\n    .t, p, div {\n      color: ").concat(getComputedStyle(document.body).getPropertyValue("--ion-text-color"),";\n      font-family: ").concat(getComputedStyle(document.body).getPropertyValue("--ion-font-family"),";\n      font-size: ").concat(this.props.fontSize,"px;\n    }\n    \n    /* Disable this to workaround epubjs page counting problem.\n    #back, #cbeta-copyright {\n      display: ").concat(this.props.showComments?"block":"none",";\n    }*/\n    ")),this.epub.writeEPUB((function(e){console.log("Error: ".concat(e))}),".","temp",Object(u.a)(l.a.mark((function e(){var n,r,o,s,i,c,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a(49),o=r.readFileSync("temp.epub"),t.book=Object(Y.a)(o.buffer,{openAs:"binary"}),t.rendition=t.book.renderTo("cbetarEPubView",{width:"100%",height:"100%",spread:"none",flow:t.props.paginated?"paginated":"scrolled",scrollbarWidth:z.scrollbarSizeIdToValue(t.props.scrollbarSize),defaultDirection:t.props.rtlVerticalLayout?"rtl":"ltr"}),t.rendition.on("selected",(function(e,a){t.epubcfi=e})),s=t.hasBookmark?t.bookmark.epubcfi:"epubcfi(/6/6[s1]!/4/4/2/6[body]/6,/1:0,/1:1)",e.next=8,t.rendition.display(t.props.paginated?s:void 0);case 8:if(t.props.paginated){e.next=13;break}return e.next=11,null===(i=t.rendition)||void 0===i?void 0:i.next();case 11:return e.next=13,null===(c=t.rendition)||void 0===c?void 0:c.next();case 13:if(t.setState({isLoading:!1}),t.hasBookmark)try{null===(u=t.rendition)||void 0===u||u.annotations.highlight(s)}catch(l){console.error(l)}null===(n=t.book)||void 0===n||n.locations.generate(150);case 16:case"end":return e.stop()}}),e)}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=r.a.createElement(v.g,null,r.a.createElement(v.E,null,r.a.createElement(v.B,{style:{fontSize:"var(--ui-font-size)"}},this.props.match.params.label),r.a.createElement(v.c,{hidden:this.isTopPage,fill:"clear",slot:"start",onClick:function(t){return e.props.history.goBack()}},r.a.createElement(v.h,{icon:_.a,slot:"icon-only"})),r.a.createElement(v.c,{fill:"clear",slot:"end",onClick:function(t){var a,n,r=speechSynthesis.getVoices();if(0!==r.length)switch(e.state.speechState){case L.UNINITIAL:var o=r.find((function(e){return e.lang.indexOf("zh-TW")>-1||e.lang.indexOf("zh_TW")>-1}));void 0!==o&&(e.speechSynthesisUtterance.voice=o);var s=(null===(a=document.getElementsByTagName("iframe")[0].contentDocument)||void 0===a||null===(n=a.getElementById("body"))||void 0===n?void 0:n.innerText)||"\u7121\u6cd5\u53d6\u5f97\u7d93\u6587\u5167\u5bb9";e.workTexts=[];for(var i=0;i<Math.ceil(s.length/e.maxCharsPerUtterance);i++)e.workTexts.push(s.substring(i*e.maxCharsPerUtterance,(i+1)*e.maxCharsPerUtterance));e.workTextsIndex=0,e.speechSynthesisUtterance.text=e.workTexts[e.workTextsIndex],e.speechSynthesisUtterance.rate=e.props.speechRate,speechSynthesis.cancel(),speechSynthesis.speak(e.speechSynthesisUtterance),e.setState({speechState:L.SPEAKING});break;case L.SPEAKING:speechSynthesis.cancel(),e.setState({speechState:L.UNINITIAL});break;case L.PAUSE:speechSynthesis.resume(),e.setState({speechState:L.SPEAKING})}}},r.a.createElement(v.h,{icon:this.state.speechState===L.SPEAKING?_.E:_.w,slot:"icon-only"})),r.a.createElement(v.c,{fill:"clear",slot:"end",onClick:function(t){return e.setState({popover:{show:!0,event:t.nativeEvent}})}},r.a.createElement(v.h,{ios:_.o,md:_.p,slot:"icon-only"})),r.a.createElement(v.q,{isOpen:this.state.popover.show,event:this.state.popover.event,onDidDismiss:function(t){e.setState({popover:{show:!1,event:null}})}},r.a.createElement(v.n,null,r.a.createElement(v.i,{button:!0,onClick:function(t){e.props.history.push("/".concat(e.props.match.params.tab)),e.setState({popover:{show:!1,event:null}})}},r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.r,slot:"start"}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u56de\u9996\u9801")),r.a.createElement(v.i,{button:!0,onClick:function(t){e.setState({popover:{show:!1,event:null}}),e.setState({showSearchAlert:!0})}},r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.A,slot:"start"}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u641c\u5c0b\u7d93\u6587")),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.F,slot:"start"}),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u8df3\u9801(%)"),r.a.createElement(v.s,{min:0,max:100,step:10,snaps:!0,pin:!0,onIonChange:function(t){var a,n=t.detail.value/100+"";n="0"===n||"1"===n?"".concat(n,".0"):n,null===(a=e.rendition)||void 0===a||a.display(n)}}))),r.a.createElement(v.i,{button:!0,onClick:function(t){e.setState({popover:{show:!1,event:null}}),e.addBookmarkHandler()}},r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.e,slot:"start"}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u65b0\u589e\u66f8\u7c64")),r.a.createElement(v.i,{button:!0,onClick:function(t){var a;e.setState({popover:{show:!1,event:null}});var n=null===(a=document.getElementsByTagName("iframe")[0].contentDocument)||void 0===a?void 0:a.getSelection();if(((null===n||void 0===n?void 0:n.rangeCount)||0)>0&&n.getRangeAt(0).toString().length>0){var r=n.getRangeAt(0).toString();e.props.history.push({pathname:"/dictionary/search/".concat(r)})}else e.setState({showNoSelectedTextAlert:!0})}},r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.d,slot:"start"}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u67e5\u8a5e\u5178")))))),a=r.a.createElement(r.a.Fragment,null,r.a.createElement(v.e,{vertical:"center",horizontal:"start",slot:"fixed"},r.a.createElement(v.f,{style:{opacity:.2},onClick:function(t){return e.props.rtlVerticalLayout?e.pageNext():e.pagePrev()},onTouchStart:function(e){e.currentTarget.style.setProperty("opacity","1")},onMouseOver:function(e){z.isTouchDevice()||e.currentTarget.style.setProperty("opacity","1")},onTouchEnd:function(e){e.currentTarget.style.setProperty("opacity","".concat(.2))},onMouseLeave:function(e){z.isTouchDevice()||e.currentTarget.style.setProperty("opacity","".concat(.2))}},r.a.createElement(v.h,{icon:_.a}))),r.a.createElement(v.e,{vertical:"center",horizontal:"end",slot:"fixed"},r.a.createElement(v.f,{style:{opacity:.2},onClick:function(t){return e.props.rtlVerticalLayout?e.pagePrev():e.pageNext()},onTouchStart:function(e){e.currentTarget.style.setProperty("opacity","1")},onMouseOver:function(e){z.isTouchDevice()||e.currentTarget.style.setProperty("opacity","1")},onTouchEnd:function(e){e.currentTarget.style.setProperty("opacity","".concat(.2))},onMouseLeave:function(e){z.isTouchDevice()||e.currentTarget.style.setProperty("opacity","".concat(.2))}},r.a.createElement(v.h,{icon:_.c}))));return this.bookCreated||null==this.state.htmlStr||this.html2Epub(),r.a.createElement(v.p,null,t,r.a.createElement(v.d,null,this.props.paginated?a:r.a.createElement(r.a.Fragment,null),r.a.createElement(v.o,{cssClass:"uiFont",isOpen:this.state.isLoading,onDidDismiss:function(){return e.setState({isLoading:!1})},message:"\u8f09\u5165\u4e2d..."}),this.state.fetchError?z.fetchErrorContent:r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{id:"cbetarEPubView",style:{width:"100%",height:"100%",userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:"\n            ".concat(this.props.rtlVerticalLayout&&!this.props.paginated?"\n    <style>\n    .epub-view {\n      height: 100% !important;\n    }\n    </style>\n    ":"","\n            ")}}),r.a.createElement(D,Object(E.a)({showSearchAlert:this.state.showSearchAlert,searchCancel:function(){e.setState({showSearchAlert:!1})},searchOk:function(t){e.props.history.push("/catalog/search/".concat(t)),e.setState({showSearchAlert:!1})}},this.props)),r.a.createElement(v.a,{cssClass:"uiFont",isOpen:this.state.showNoSelectedTextAlert,backdropDismiss:!1,header:"\u5931\u6557",message:"\u8acb\u78ba\u8a8d\u662f\u5426\u5df2\u9078\u64c7\u4e00\u6bb5\u6587\u5b57\uff0c\u7136\u5f8c\u518d\u57f7\u884c\u6240\u9078\u7684\u529f\u80fd!",buttons:[{text:"\u78ba\u5b9a",cssClass:"primary uiFont",handler:function(t){e.setState({showNoSelectedTextAlert:!1})}}]}),r.a.createElement(v.C,{cssClass:"uiFont",isOpen:this.state.showAddBookmarkSuccess,onDidDismiss:function(){return e.setState({showAddBookmarkSuccess:!1})},message:"\u66f8\u7c64\u65b0\u589e\u6210\u529f\uff01",duration:2e3})))}},{key:"fileName",get:function(){return z.getFileName(this.props.match.params.work,this.props.match.params.path)}},{key:"isTopPage",get:function(){return"/catalog"===this.props.match.url}},{key:"bookmark",get:function(){var e=this;return this.props.bookmarks.find((function(t){return t.type===T.JUAN&&t.uuid===e.uuidStr}))}},{key:"hasBookmark",get:function(){return null!=this.bookmark}}]),n}(r.a.Component),Z=Object(v.P)(X),Q=Object(y.b)((function(e){return{bookmarks:e.settings.bookmarks,fontSize:e.settings.fontSize,showComments:e.settings.showComments,paginated:e.settings.paginated,rtlVerticalLayout:e.settings.rtlVerticalLayout,settings:e.settings,scrollbarSize:e.settings.scrollbarSize,speechRate:e.settings.speechRate}}))(Z),$=(a(388),a(389),a(390),a(391),a(392),a(393),a(394),a(395),a(396),a(397),a(398),a(399),a(204)),ee=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).state={showFontLicense:!1,juansDownloadedRatio:0,showUpdateAllJuansDone:!1},n}return Object(h.a)(a,[{key:"updateAllJuans",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,a,n,r,o,s,i,c,u,p,h,m,d,f,v,k,y,b,g,E;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.setState({juansDownloadedRatio:0}),t=this.props.bookmarks.filter((function(e){return e.type===T.WORK})),a=this.props.bookmarks.filter((function(e){return e.type===T.JUAN})),n=a.filter((function(e){return-1===t.findIndex((function(t){var a,n;return(null===(a=t.work)||void 0===a?void 0:a.work)===(null===(n=e.work)||void 0===n?void 0:n.work)}))})),r=n.length,o=0;o<t.length;o++)s=t[o].work,r+=s.juan_list.split(",").length;i=0,c=0;case 8:if(!(c<t.length)){e.next=29;break}u=t[c],p=u.work,h=p.juan_list.split(","),m=0;case 13:if(!(m<h.length)){e.next=26;break}return d=h[m],i+=1,this.setState({juansDownloadedRatio:i/r}),e.next=19,z.fetchJuan(p.work,d,null,!0);case 19:f=e.sent,v=z.getFileName(p.work,d),localStorage.setItem(v,f),console.log("File saved: ".concat(v));case 23:m++,e.next=13;break;case 26:c++,e.next=8;break;case 29:k=0;case 30:if(!(k<n.length)){e.next=44;break}return i+=1,this.setState({juansDownloadedRatio:i/r}),y=n[k],b=y.work,e.next=37,z.fetchJuan(b.work,"".concat(b.juan),null,!0);case 37:g=e.sent,E=z.getFileName(b.work,"".concat(b.juan)),localStorage.setItem(E,g),console.log("File saved: ".concat(E));case 41:k++,e.next=30;break;case 44:this.setState({showUpdateAllJuansDone:!0});case 45:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(v.p,null,r.a.createElement(v.g,null,r.a.createElement(v.E,null,r.a.createElement(v.B,{style:{fontSize:"var(--ui-font-size)"}},"\u8a2d\u5b9a"))),r.a.createElement(v.d,null,r.a.createElement(v.n,null,r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.x,slot:"start"}),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u96fb\u5b50\u4f5b\u5178app\u7248\u672c: ",$.version),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u6aa2\u67e5app\u66f4\u65b0 (\u82e5\u7121\u66f4\u65b0\u5247\u7121\u56de\u61c9)")),r.a.createElement(v.c,{slot:"end",size:"large",style:{fontSize:"var(--ui-font-size)"},onClick:function(e){z.updateApp()}},"\u6aa2\u67e5")),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.x,slot:"start"}),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u66f4\u65b0\u96e2\u7dda\u7d93\u6587\u6a94"),r.a.createElement(v.r,{value:this.state.juansDownloadedRatio})),r.a.createElement(v.c,{slot:"end",size:"large",style:{fontSize:"var(--ui-font-size)"},onClick:function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.updateAllJuans());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},"\u66f4\u65b0"),r.a.createElement(v.C,{cssClass:"uiFont",isOpen:this.state.showUpdateAllJuansDone,onDidDismiss:function(){return e.setState({showUpdateAllJuansDone:!1})},message:"\u96e2\u7dda\u7d93\u6587\u6a94\u66f4\u65b0\u5b8c\u7562\uff01",duration:2e3})),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.l,slot:"start"}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u4f48\u666f\u4e3b\u984c"),r.a.createElement(v.w,{slot:"end",value:this.props.theme,style:{fontSize:"var(--ui-font-size)"},interface:"popover",interfaceOptions:{cssClass:"cbetar2themes"},onIonChange:function(t){var a=t.detail.value;e.props.dispatch({type:"SET_KEY_VAL",key:"theme",val:a}),document.body.classList.forEach((function(e){return document.body.classList.remove(e)})),document.body.classList.toggle("theme".concat(a),!0)}},r.a.createElement(v.x,{className:"cbeta",value:0},"CBETA"),r.a.createElement(v.x,{className:"dark",value:1},"\u6697\u8272"),r.a.createElement(v.x,{className:"light",value:2},"\u4eae\u8272"),r.a.createElement(v.x,{className:"oldPaper",value:3},"\u820a\u66f8"),r.a.createElement(v.x,{className:"marble",value:4},"\u5927\u7406\u77f3"))),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.m,slot:"start"}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u7d93\u6587\u76f4\u5f0f\u3001\u53f3\u81f3\u5de6\u66f8\u5beb"),r.a.createElement(v.D,{slot:"end",checked:this.props.rtlVerticalLayout,onIonChange:function(t){var a=t.detail.checked;e.props.dispatch({type:"SET_KEY_VAL",key:"rtlVerticalLayout",val:a})}})),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.m,slot:"start"}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u55ae\u9801/\u5206\u9801"),r.a.createElement(v.D,{slot:"end",checked:this.props.paginated,onIonChange:function(t){var a=t.detail.checked;e.props.dispatch({type:"SET_KEY_VAL",key:"paginated",val:a})}})),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.m,slot:"start"}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u55ae\u9801\u7d93\u6587\u6372\u8ef8\u5927\u5c0f"),r.a.createElement(v.w,{slot:"end",value:this.props.scrollbarSize,style:{fontSize:"var(--ui-font-size)"},interface:"popover",interfaceOptions:{cssClass:"uiFont"},onIonChange:function(t){var a=t.detail.value;e.props.dispatch({type:"SET_KEY_VAL",key:"scrollbarSize",val:a}),z.updateCssVars(e.props.settings)}},r.a.createElement(v.x,{value:0},"\u7121"),r.a.createElement(v.x,{value:1},"\u4e2d"),r.a.createElement(v.x,{value:2},"\u5927"))),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.F,slot:"start"}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u9ed1\u9ad4/\u6977\u66f8\u5b57\u9ad4(\u521d\u6b21\u8f09\u5165\u8981\u7b49\u5f85)"),r.a.createElement(v.D,{slot:"end",checked:this.props.useFontKai,onIonChange:function(t){var a=t.detail.checked;e.props.dispatch({type:"SET_KEY_VAL",key:"useFontKai",val:a}),z.updateCssVars(e.props.settings)}})),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.F,slot:"start"}),r.a.createElement("div",{className:"contentBlock"},r.a.createElement("div",{style:{flexDirection:"column"}},r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"UI\u5b57\u578b\u5927\u5c0f: ",this.props.uiFontSize),r.a.createElement(v.s,{min:10,max:64,value:this.props.uiFontSize,onIonChange:function(t){e.props.dispatch({type:"SET_KEY_VAL",key:"uiFontSize",val:t.detail.value}),z.updateCssVars(e.props.settings)}})))),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.F,slot:"start"}),r.a.createElement("div",{className:"contentBlock"},r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u7d93\u6587\u5b57\u578b\u5927\u5c0f: ",this.props.settings.fontSize),r.a.createElement(v.s,{min:10,max:64,value:this.props.settings.fontSize,onIonChange:function(t){e.props.dispatch({type:"SET_KEY_VAL",key:"fontSize",val:t.detail.value})}}))),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.v,slot:"start"}),r.a.createElement("div",{className:"contentBlock"},r.a.createElement("div",{style:{flexDirection:"column"}},r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"}},"\u5408\u6210\u8a9e\u97f3\u8a9e\u901f: ",this.props.speechRate),r.a.createElement(v.s,{min:.1,max:1.5,step:.1,value:this.props.speechRate,onIonChange:function(t){e.props.dispatch({type:"SET_KEY_VAL",key:"speechRate",val:t.detail.value.toFixed(1)})}})))),r.a.createElement(v.i,null,r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.h,{icon:_.q,slot:"start"}),r.a.createElement("div",{style:{fontSize:"var(--ui-font-size)"}},r.a.createElement("div",null,"\u95dc\u65bc"),r.a.createElement("div",null,r.a.createElement("a",{href:"https://github.com/MrMYHuang/cbetar2#web-app",target:"_new"},"\u7a0b\u5f0f\u5b89\u88dd\u8aaa\u660e")),r.a.createElement("div",null,r.a.createElement("a",{href:"https://github.com/MrMYHuang/cbetar2",target:"_new"},"\u64cd\u4f5c\u8aaa\u660e\u8207\u958b\u653e\u539f\u59cb\u78bc")),r.a.createElement("div",null,"CBETA API\u7248\u672c: ",z.apiVersion),r.a.createElement("div",null,r.a.createElement("a",{href:"http://cbdata.dila.edu.tw/v1.2/",target:"_new"},"CBETA API\u53c3\u8003\u6587\u4ef6")),r.a.createElement("div",null,r.a.createElement("a",{href:"http://glossaries.dila.edu.tw/?locale=zh-TW",target:"_new"},"DILA \u4f5b\u5b78\u8853\u8a9e\u5b57\u8fad\u5178")),r.a.createElement("div",null,"\u4f5c\u8005: Meng-Yuan Huang"),r.a.createElement("div",null,r.a.createElement("a",{href:"mailto:myh@live.com",target:"_new"},"myh@live.com")),r.a.createElement("div",null,r.a.createElement("a",{href:"/",onClick:function(t){t.preventDefault(),e.setState({showFontLicense:!0})}},"\u5168\u5b57\u5eab\u5b57\u578b\u7248\u6b0a\u8072\u660e")))),r.a.createElement(v.a,{cssClass:"uiFont",isOpen:this.state.showFontLicense,backdropDismiss:!1,message:"\u6b64app\u4f7f\u7528\u7684\u5168\u5b57\u5eab\u5b57\u578b(2020-08-18\u7248)\u7531\u570b\u5bb6\u767c\u5c55\u59d4\u54e1\u6703\u63d0\u4f9b\u3002\u6b64\u958b\u653e\u8cc7\u6599\u4f9d\u653f\u5e9c\u8cc7\u6599\u958b\u653e\u6388\u6b0a\u689d\u6b3e (Open Government Data License) \u9032\u884c\u516c\u773e\u91cb\u51fa\uff0c\u4f7f\u7528\u8005\u65bc\u9075\u5b88\u672c\u689d\u6b3e\u5404\u9805\u898f\u5b9a\u4e4b\u524d\u63d0\u4e0b\uff0c\u5f97\u5229\u7528\u4e4b\u3002\u653f\u5e9c\u8cc7\u6599\u958b\u653e\u6388\u6b0a\u689d\u6b3e\uff1ahttps://data.gov.tw/license",buttons:[{text:"\u95dc\u9589",cssClass:"primary uiFont",handler:function(t){e.setState({showFontLicense:!1})}},{text:"\u958b\u555f\u6388\u6b0a",cssClass:"secondary uiFont",handler:function(t){e.setState({showFontLicense:!1}),window.open("https://data.gov.tw/license")}}]}))))}}]),a}(r.a.Component),te=Object(y.b)((function(e){return{settings:e.settings,theme:e.settings.theme,showComments:e.settings.showComments,paginated:e.settings.paginated,rtlVerticalLayout:e.settings.rtlVerticalLayout,scrollbarSize:e.settings.scrollbarSize,useFontKai:e.settings.useFontKai,uiFontSize:e.settings.uiFontSize,speechRate:e.settings.speechRate,bookmarks:e.settings.bookmarks}}))(ee),ae=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).bookmarkListRef=void 0,n.state={work:null},n.bookmarkListRef=r.a.createRef(),n}return Object(h.a)(a,[{key:"ionViewWillEnter",value:function(){}},{key:"delBookmarkHandler",value:function(e){this.props.dispatch({type:"DEL_BOOKMARK",uuid:e})}},{key:"render",value:function(){var e=this,t=this.props.bookmarks,a=Array();return t.forEach((function(t,n){var o,s,i,c,p,h="",m="".concat(t.selectedText);switch(t.type){case T.CATALOG:h="/catalog/catalog/".concat(t.uuid,"/").concat(m);break;case T.WORK:h="/catalog/work/".concat(t.uuid,"/").concat(m);break;case T.JUAN:h="/catalog/webview/".concat(null===(o=t.work)||void 0===o?void 0:o.work,"/").concat(null===(s=t.work)||void 0===s?void 0:s.juan,"/").concat(null===(i=t.work)||void 0===i?void 0:i.title),m="".concat(null===(c=t.work)||void 0===c?void 0:c.title,"\u7b2c").concat(null===(p=t.work)||void 0===p?void 0:p.juan,"\u5377 - ").concat(m)}a.push(r.a.createElement(v.l,{key:"bookmarkItemSliding_"+n},r.a.createElement(v.i,{key:"bookmarkItem_"+n,button:!0,onClick:function(){var a=Object(u.a)(l.a.mark((function a(n){return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n.preventDefault(),e.props.history.push({pathname:h,state:{uuid:t.uuid}});case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"},key:"bookmarkItemLabel_"+n},m),t.type===T.CATALOG?"":r.a.createElement(v.h,{icon:_.n,slot:"end"})),r.a.createElement(v.k,{side:"end"},r.a.createElement(v.j,{style:{fontSize:"var(--ui-font-size)"},color:"danger",onClick:function(a){var n;e.delBookmarkHandler(t.uuid),null===(n=e.bookmarkListRef.current)||void 0===n||n.closeSlidingItems()}},"\u522a\u9664"))))})),r.a.createElement(v.p,null,r.a.createElement(v.g,null,r.a.createElement(v.E,null,r.a.createElement(v.B,{style:{fontSize:"var(--ui-font-size)"}},"\u66f8\u7c64"))),r.a.createElement(v.d,null,this.hasBookmark?r.a.createElement(v.n,{ref:this.bookmarkListRef},a):r.a.createElement(v.m,{className:"contentCenter"},r.a.createElement("div",null,r.a.createElement("div",null,"\u7121\u66f8\u7c64"),r.a.createElement("div",{style:{fontSize:"var(--ui-font-size)",paddingTop:24}},"\u8acb\u5207\u63db\u81f3\u76ee\u9304\u9801\u65b0\u589e"))),r.a.createElement("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"}},"\u53ef\u96e2\u7dda\u700f\u89bd\u5716\u793a ",r.a.createElement(v.h,{icon:_.n})),r.a.createElement("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"}},r.a.createElement("a",{href:"https://github.com/MrMYHuang/cbetar2#bookmark",target:"_new"},"\u66f8\u7c64\u65b0\u589e\u8aaa\u660e")),r.a.createElement("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"}},r.a.createElement("a",{href:"https://github.com/MrMYHuang/cbetar2#web-app",target:"_new"},"\u7a0b\u5f0f\u5b89\u88dd\u8aaa\u660e"))))}},{key:"hasBookmark",get:function(){return this.props.bookmarks.length>0}}]),a}(r.a.Component),ne=Object(v.P)(ae),re=Object(y.b)((function(e){return{bookmarks:e.settings.bookmarks}}))(ne),oe=function e(t){var a;Object(p.a)(this,e),this.type=void 0,this.n=void 0,this.label=void 0,this.work=void 0,this.title=void 0,this.creators=void 0,this.type=t.type,this.n=t.n,this.label=t.label,this.work=t.work,this.title=t.title,this.creators=null!==(a=t.creators)&&void 0!==a?a:"\u7121"},se=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).state={searches:[]},n}return Object(h.a)(a,[{key:"ionViewWillEnter",value:function(){this.search(this.props.match.params.keyword)}},{key:"search",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z.axiosInstance.get("/toc?q=".concat(t),{responseType:"arraybuffer"});case 3:return a=e.sent,n=JSON.parse((new TextDecoder).decode(a.data)).results,r=n.map((function(e){return new oe(e)})),this.setState({searches:r}),e.abrupt("return",!0);case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getRows",value:function(){var e=this,t=Array();return this.state.searches.forEach((function(a,n){var o="catalog"===a.type,s=o?a.label:"".concat(a.title,"\n\u4f5c\u8005:").concat(a.creators),i="/".concat(e.props.match.params.tab)+(o?"/catalog/".concat(a.n):"/work/".concat(a.work))+"/".concat(a.title);t.push(r.a.createElement(v.i,{key:"searchItem_"+n,button:!0,onClick:function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),e.props.history.push({pathname:i});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},r.a.createElement("div",{tabIndex:0}),r.a.createElement(v.m,{className:"ion-text-wrap",style:{fontSize:"var(--ui-font-size)"},key:"searchLabel_"+n},s)))})),t}},{key:"render",value:function(){var e=this,t=this.getRows();return r.a.createElement(v.p,null,r.a.createElement(v.g,null,r.a.createElement(v.E,null,r.a.createElement(v.B,{style:{fontSize:"var(--ui-font-size)"}},"\u641c\u5c0b - ",this.props.match.params.keyword),r.a.createElement(v.c,{hidden:this.isTopPage,fill:"clear",slot:"start",onClick:function(t){return e.props.history.goBack()}},r.a.createElement(v.h,{icon:_.a,slot:"icon-only"})),r.a.createElement(v.c,{fill:"clear",slot:"end",onClick:function(t){return e.props.history.push("/".concat(e.props.match.params.tab))}},r.a.createElement(v.h,{icon:_.r,slot:"icon-only"})),r.a.createElement(v.c,{fill:"clear",slot:"end",onClick:function(t){return e.setState({showSearchAlert:!0})}},r.a.createElement(v.h,{icon:_.A,slot:"icon-only"})))),r.a.createElement(v.d,null,r.a.createElement(v.n,null,t),r.a.createElement(D,Object(E.a)({showSearchAlert:this.state.showSearchAlert,searchCancel:function(){e.setState({showSearchAlert:!1})},searchOk:function(t){e.props.history.push("/catalog/search/".concat(t)),e.setState({showSearchAlert:!1})}},this.props))))}},{key:"isTopPage",get:function(){return"/catalog"===this.props.match.url}}]),a}(r.a.Component),ie=Object(v.P)(se),ce=Object(y.b)((function(e){return{}}))(ie),le=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).searchBarRef=void 0,n.state={keyword:"",searches:[]},n.searchBarRef=r.a.createRef(),n}return Object(h.a)(a,[{key:"ionViewWillEnter",value:function(){this.props.match.params.keyword&&(this.setState({keyword:this.props.match.params.keyword}),this.lookupDict(this.props.match.params.keyword))}},{key:"ionViewWillLeave",value:function(){}},{key:"lookupDict",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.axiosInstance.get("".concat(z.dilaDictApiUrl,"/?type=match&dicts=dila&term=").concat(t),{responseType:"json"});case 2:a=e.sent,this.setState({searches:a.data});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRows",value:function(){var e=this.state.searches,t=Array();return e.forEach((function(e,a){t.push(r.a.createElement(v.i,{key:"dictItem"+a},r.a.createElement("div",{tabIndex:0}),r.a.createElement("div",null,r.a.createElement("div",{className:"ion-text-wrap uiFont",style:{color:"var(--ion-color-primary)"},dangerouslySetInnerHTML:{__html:e.dict_name_zh}}),r.a.createElement("div",{className:"ion-text-wrap uiFont",key:"dictItemLabel"+a,dangerouslySetInnerHTML:{__html:e.desc}}))))})),t}},{key:"render",value:function(){var e=this;return r.a.createElement(v.p,null,r.a.createElement(v.g,null,r.a.createElement(v.E,null,r.a.createElement(v.B,{style:{fontSize:"var(--ui-font-size)"}},"\u4f5b\u5b78\u8a5e\u5178"),r.a.createElement(v.c,{hidden:this.isTopPage,fill:"clear",slot:"start",onClick:function(t){return e.props.history.goBack()}},r.a.createElement(v.h,{icon:_.a,slot:"icon-only"})),r.a.createElement(v.c,{fill:"clear",slot:"end",onClick:function(t){return e.props.history.push("/".concat(e.props.match.params.tab))}},r.a.createElement(v.h,{icon:_.r,slot:"icon-only"})))),r.a.createElement(v.d,null,r.a.createElement(v.n,null,r.a.createElement(v.i,null,r.a.createElement(v.v,{ref:this.searchBarRef,placeholder:"\u8acb\u8f38\u5165\u5b57\u8a5e\uff0c\u518d\u6309\u9375\u76e4Enter\u9375",value:this.state.keyword,onIonChange:function(t){e.setState({keyword:t.detail.value})},onIonClear:function(t){e.setState({searches:[]})},onKeyUp:function(t){"Enter"===t.key&&e.lookupDict(e.state.keyword)}})),this.getRows()),r.a.createElement("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"}},r.a.createElement("a",{href:"https://github.com/MrMYHuang/cbetar2#dictionary",target:"_new"},"\u4f5b\u5b78\u8a5e\u5178\u8aaa\u660e"))))}},{key:"isTopPage",get:function(){return"/catalog"===this.props.match.url}}]),a}(r.a.Component),ue=Object(v.P)(le),pe=Object(y.b)((function(e){return{}}))(ue),he=function(){var e=localStorage.getItem(z.storeFile);return null!=e?Object(b.c)(I,JSON.parse(e)):Object(b.c)(I)}(),me=he.getState();Object(v.O)({swipeBackEnabled:!1});var de={onSuccess:function(){},onUpdate:function(){}},fe=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).wakeLock=void 0,document.body.classList.forEach((function(e){return document.body.classList.remove(e)})),document.body.classList.toggle("theme".concat(me.settings.theme),!0),z.updateCssVars(me.settings),n.state={showUpdateAlert:!1},de.onUpdate=function(){n.setState({showUpdateAlert:!0})},de.onSuccess=function(){},speechSynthesis.getVoices(),speechSynthesis.cancel(),n.wakeLockScreen(),n}return Object(h.a)(a,[{key:"wakeLockScreen",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,void 0===(t=navigator.wakeLock)){e.next=7;break}return e.next=5,t.request("screen");case 5:this.wakeLock=e.sent,console.log("Auto screen lock is disabled.");case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("".concat(e.t0.name,", ").concat(e.t0.message));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"routeByQueryString",value:function(){var e=/\?route=(.*)/.exec(window.location.search);return null!==e?r.a.createElement(f.a,{to:e[1]}):"/"===window.location.pathname?r.a.createElement(f.a,{to:"/bookmarks"}):void 0}},{key:"render",value:function(){var e=this;return r.a.createElement(y.a,{store:he},r.a.createElement(v.b,null,r.a.createElement(k.a,null,r.a.createElement(v.A,null,r.a.createElement(v.u,{animated:!1},r.a.createElement(f.b,{path:"/:tab(catalog)/webview/:work/:path/:label",render:function(e){return r.a.createElement(Q,e)},exact:!0}),r.a.createElement(f.b,{path:"/:tab(catalog)/work/:path/:label",component:function(e){return r.a.createElement(K,e)},exact:!0}),r.a.createElement(f.b,{path:"/:tab(catalog)/search/:keyword",render:function(e){return r.a.createElement(ce,e)},exact:!0}),r.a.createElement(f.b,{path:"/:tab(catalog)/catalog/:path/:label",component:function(e){return r.a.createElement(U,e)},exact:!0}),r.a.createElement(f.b,{path:"/:tab(catalog)",component:function(e){return r.a.createElement(U,e)},exact:!0}),r.a.createElement(f.b,{path:"/:tab(bookmarks)",component:re,exact:!0}),r.a.createElement(f.b,{path:"/:tab(bookmarks)/search/:keyword",render:function(e){return r.a.createElement(ce,e)},exact:!0}),r.a.createElement(f.b,{path:"/:tab(dictionary)",render:function(e){return r.a.createElement(pe,e)},exact:!0}),r.a.createElement(f.b,{path:"/:tab(dictionary)/search/:keyword",render:function(e){return r.a.createElement(pe,e)},exact:!0}),r.a.createElement(f.b,{path:"/settings",component:te}),r.a.createElement(f.b,{path:"/",render:function(){return e.routeByQueryString()},exact:!0})),r.a.createElement(v.y,{slot:"bottom"},r.a.createElement(v.z,{tab:"bookmarks",href:"/bookmarks"},r.a.createElement(v.h,{icon:_.e})),r.a.createElement(v.z,{tab:"catalog",href:"/catalog"},r.a.createElement(v.h,{icon:_.s})),r.a.createElement(v.z,{tab:"dictionay",href:"/dictionary"},r.a.createElement(v.h,{icon:_.d})),r.a.createElement(v.z,{tab:"settings",href:"/settings"},r.a.createElement(v.h,{icon:_.D}))))),r.a.createElement(v.a,{cssClass:"uiFont",isOpen:this.state.showUpdateAlert,backdropDismiss:!1,header:"\u767c\u73feapp\u66f4\u65b0\uff0c\u8acb\u91cd\u555fapp!\u91cd\u555f\u5f8c\u53ef\u81f3\u8a2d\u5b9a\u9801\u6aa2\u67e5\u7248\u672c\u865f\u3002",buttons:[{text:"\u95dc\u9589",cssClass:"primary uiFont",handler:function(t){e.setState({showUpdateAlert:!1})}},{text:"\u986f\u793a\u7248\u672c\u6b77\u53f2",cssClass:"secondary uiFont",handler:function(e){window.open("https://github.com/MrMYHuang/cbetar2#%E7%89%88%E6%9C%AC%E6%AD%B7%E5%8F%B2")}}]})))}}]),a}(r.a.Component),ve=Object(f.f)(fe),ke=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ye(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.postMessage({type:"SKIP_WAITING"}),a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(r.a.createElement(i.a,null,r.a.createElement(ve,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");ke?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ye(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ye(t,e)}))}}({onSuccess:function(){console.log("Precache app loaded!"),de.onSuccess()},onUpdate:function(){console.log("Found app updated!"),de.onUpdate()}})}},[[207,3,4]]]);
//# sourceMappingURL=main.0a9b2fab.chunk.js.map